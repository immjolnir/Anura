<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Stammerer</title>
        <meta name="robots" content="noindex" />


        <!-- Custom HTML head -->
        
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="Cpp/index.html"><strong aria-hidden="true">1.</strong> C++</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="Cpp/CodeReview.html"><strong aria-hidden="true">1.1.</strong> Code Review</a></li><li class="chapter-item expanded "><a href="Cpp/Date/index.html"><strong aria-hidden="true">1.2.</strong> Date</a></li></ol></li><li class="chapter-item expanded "><a href="Docker/READEM.html"><strong aria-hidden="true">2.</strong> Docker</a></li><li class="chapter-item expanded "><a href="IDE/index.html"><strong aria-hidden="true">3.</strong> IDE</a></li><li class="chapter-item expanded "><a href="Git/index.html"><strong aria-hidden="true">4.</strong> Git</a></li><li class="chapter-item expanded "><a href="Screen/index.html"><strong aria-hidden="true">5.</strong> Screen</a></li><li class="chapter-item expanded "><a href="SQLite/index.html"><strong aria-hidden="true">6.</strong> SQLite</a></li><li class="chapter-item expanded "><a href="Ubuntu/index.html"><strong aria-hidden="true">7.</strong> Ubuntu</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Stammerer</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="c"><a class="header" href="#c">C++</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="code-review"><a class="header" href="#code-review">Code Review</a></h1>
<h2 id="a-valuable--comprehensive-firmware-code-review-by-codethink"><a class="header" href="#a-valuable--comprehensive-firmware-code-review-by-codethink"><a href="https://www.codethink.co.uk/articles/2022/asl-testimonial/">A Valuable &amp; Comprehensive Firmware Code Review by Codethink</a></a></h2>
<h3 id="what-is-the-point-of-this-code-review"><a class="header" href="#what-is-the-point-of-this-code-review">What is the point of this code review?</a></h3>
<p>When performing a code review we should always ask ourselves what the point of the review actually is, and try to answer some basic questions.</p>
<h3 id="who-is-the-target-audience-for-the-review"><a class="header" href="#who-is-the-target-audience-for-the-review">Who is the target audience for the review?</a></h3>
<p>A <strong>junior</strong> developer may request a review as a learning experience, and would expect any response to be as verbose and educational as possible.</p>
<p>A <strong>senior</strong> developer may request a review as a sanity check and will often expect a review to be as technically in-depth as possible to catch/discuss potential issues.</p>
<p>A <strong>manager</strong> may request a review either directly or as part of a company process, in this case they will need a high level summary to provide them feedback on the overall code quality on the project and as a feedback mechanism to feed into any personal development programs.</p>
<p>A <strong>company</strong> may request a review as part of an evidence chain for safety/security certification or approval, such a review would be expected to be as formal and verbose as possible as it will need to be referenced in the future.</p>
<p>In practice all code reviews are a mixture of the above, and before undertaking a code review it’s important to gauge the audience as the wrong review focus or format could lead to a bad code review.</p>
<p>In our work with ASL Holdings we were working to review their power monitoring devices for the purposes of both safety and quality. Since we knew the audience for this review from the start, it became clear that this review would need to be very technically in-depth and formal.</p>
<h3 id="what-does-a-successful-review-look-like"><a class="header" href="#what-does-a-successful-review-look-like">What does a successful review look like?</a></h3>
<p>Once we know the target audience it becomes easier to determine what results are expected. In some cases this may be covered by company process or by the request for the review, but it’s often worthwhile to directly ask the main stakeholders what they expect to get out of a code review.</p>
<p>Typical expected outcomes from a code review can vary a lot, and include:</p>
<ul>
<li>Fixing known bugs</li>
<li>Finding unknown bugs</li>
<li>Describing potential maintenance issues</li>
<li>Simplification of the codebase</li>
<li>Providing optimizations</li>
<li>Ensuring common conventions/styles are used</li>
<li>Education/Feedback</li>
</ul>
<p>For a longer form review it’s often worthwhile to state the intentions of the review up-front as this will prepare the reader for what to expect from the review.</p>
<h3 id="where-to-begin"><a class="header" href="#where-to-begin">Where to Begin?</a></h3>
<p>For a small code review it can be obvious where to begin if there’s relatively little to tackle, but this question can be more tricky to answer for large projects/commits.</p>
<p>In our work with ASL Holdings we were reviewing a mature codebase with a large number of C source and header files and no prior knowledge of the codebase. The lack of prior knowledge can be an important factor in providing an unbiased review and may be a requirement for safety, security or quality processes.</p>
<p>A larger code review should always begin with a discussion with the original author where possible as they will be able to point out any areas of concern, any known issues or any concerns they have about the code in general.</p>
<p>When digging into a large codebase it’s good to have a number of entry points as this can focus the mind, and once a high-level review of these areas is written the experience should allow for a wider understanding of the codebase.</p>
<p>Due to the requirements for the ASL Holdings code review it became obvious early on that the only acceptable outcome would be to review every single line of code.</p>
<p>Reading large quantities of code may seem daunting at first, however most codebases will have a relatively consistent style whether due to a specific code style being followed or just due to the limited number of authors. The important thing when tackling a large quantity of code is to keep very brief notes so as not to break your flow when reading through the codebase.</p>
<p>For the ASL code review we kept very brief notes indicating line-number and a couple of words to describe each issue; by keeping minimal notes this allowed us to read through the codebase quickly without interruption. When it came time to write the formal review; using only these notes it was possible to work backwards and focus on specific parts of the codebase in the review itself.</p>
<p>Reading through the codebase first also allows us to determine any recurring issues, and get a picture of how much time we’ll have available to dig into each review point.</p>
<p>Understanding how much time we had to focus and think about specific issues was important as we could plan to provide the most in-depth feedback in the time given. This allowed us to provide very in-depth feedback for the most critical point by referencing appropriate technical documentation and providing code improvement snippets.</p>
<h3 id="where-to-end"><a class="header" href="#where-to-end">Where to End?</a></h3>
<p>By determining the audience, stakeholders and expectations of the review, it becomes easier to determine where the end-point should be.</p>
<p>Typically a code review shouldn’t end until you have a full understanding of the reviewed codebase such that you can read and understand every function/file. Where this is not the case, the level of depth should be clearly mentioned in the code review.</p>
<p>Often for shorter code reviews which may be part of a company commit process there’s a temptation to review briefly and accept a change, however if it’s not clear that this has been done, then bugs and technical debt can easily build up unnoticed.</p>
<p>In the case of our review for ASL Holdings we knew that a review of the entire codebase was required for quality and safety purposes, so it became our obligation to review with a full understanding.</p>
<p>While we had gathered requirements up-front to determine what a successful review might look like, it was important to leave some time for feedback to the code review as the output in our case was a formal document.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="date"><a class="header" href="#date">Date</a></h1>
<h2 id="libraries"><a class="header" href="#libraries">Libraries</a></h2>
<ul>
<li>
<p>muduo <strong>Date</strong></p>
</li>
<li>
<p>Google's Abseil <strong>time</strong> library</p>
</li>
<li>
<p>C++11 <chrono> is garbage verbose</p>
</li>
<li>
<p>Boost::date_time is over enginnered</p>
</li>
<li>
<p>Java Joda-Time is now part of Java 8</p>
</li>
<li>
<p>Python Datetime</p>
</li>
<li>
<p>Golang</p>
</li>
</ul>
<h2 id="abseil-time-library"><a class="header" href="#abseil-time-library">Abseil <strong>time</strong> library</a></h2>
<p>Greg Miller &quot;Time Programming Fundamentals&quot;</p>
<ul>
<li>absl::CivilDay class
<ul>
<li>Internal: CCTZ
<ul>
<li>https://github.com/google/cctz</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="cposix"><a class="header" href="#cposix">C/POSIX</a></h2>
<ul>
<li>Doesn't provide date function</li>
<li>Date time calc based on unix time, time_t, i.e.
<ul>
<li>Non-leap seconds since 1970-01-01 00:00:00 UTC</li>
<li>Exposed to year 2038 problem on 32-bit platform</li>
</ul>
</li>
</ul>
<hr />
<pre><code>                  |  UTC            | Local Timezone         |
</code></pre>
<p>----------------------+-----------------+------------------------
time_t -&gt; struct tm   | gmtime/gmtime_r | localtime /localtime_r |
----------------------+-----------------+------------------------
struct tm -&gt; time_t   | timegm()        | mktime()               |
----------------------+-----------------+------------------------`</p>
<ul>
<li>Timezone is global per process. tzset()
问题就是时区对于进程是全局的 </li>
</ul>
<h1 id="timezone-conversion-by-abseil-time-libarary"><a class="header" href="#timezone-conversion-by-abseil-time-libarary">Timezone conversion by Abseil Time libarary</a></h1>
<p>UTC time ~ Unix Time(time_t)</p>
<p>Unix Time: non-leap seconds since Unix Epoch(1970-01-01 00:00::00Z)</p>
<p>3 category classes.</p>
<ul>
<li>Absolute Time: <code>absl::Time</code>, <code>absl::Duration</code></li>
<li>Time Zone: absl::timeZone</li>
<li>Civi Time:
<ul>
<li>absl::CivilYear</li>
<li>absl::CivilMonth</li>
<li>absl::CivilDay</li>
<li>absl::CivilHour</li>
<li>absl::CivilHour</li>
<li>absl::CivilMinte</li>
<li>absl::CivilSecond</li>
</ul>
</li>
</ul>
<p>Daylight Savings Time 夏令时</p>
<p>例如: 英国伦敦 GMT and BST(British Summer Time)</p>
<pre><code>$ zdump -c 2019,2025 -V Europe/London
Europe/London  Sun Mar 31 00:59:59 2019 UT = Sun Mar 31 00:59:59 2019 GMT isdst=0 gmtoff=0
Europe/London  Sun Mar 31 01:00:00 2019 UT = Sun Mar 31 02:00:00 2019 BST isdst=1 gmtoff=3600
Europe/London  Sun Oct 27 00:59:59 2019 UT = Sun Oct 27 01:59:59 2019 BST isdst=1 gmtoff=3600
Europe/London  Sun Oct 27 01:00:00 2019 UT = Sun Oct 27 01:00:00 2019 GMT isdst=0 gmtoff=0
Europe/London  Sun Mar 29 00:59:59 2020 UT = Sun Mar 29 00:59:59 2020 GMT isdst=0 gmtoff=0
Europe/London  Sun Mar 29 01:00:00 2020 UT = Sun Mar 29 02:00:00 2020 BST isdst=1 gmtoff=3600
Europe/London  Sun Oct 25 00:59:59 2020 UT = Sun Oct 25 01:59:59 2020 BST isdst=1 gmtoff=3600
Europe/London  Sun Oct 25 01:00:00 2020 UT = Sun Oct 25 01:00:00 2020 GMT isdst=0 gmtoff=0
Europe/London  Sun Mar 28 00:59:59 2021 UT = Sun Mar 28 00:59:59 2021 GMT isdst=0 gmtoff=0
Europe/London  Sun Mar 28 01:00:00 2021 UT = Sun Mar 28 02:00:00 2021 BST isdst=1 gmtoff=3600
Europe/London  Sun Oct 31 00:59:59 2021 UT = Sun Oct 31 01:59:59 2021 BST isdst=1 gmtoff=3600
Europe/London  Sun Oct 31 01:00:00 2021 UT = Sun Oct 31 01:00:00 2021 GMT isdst=0 gmtoff=0
Europe/London  Sun Mar 27 00:59:59 2022 UT = Sun Mar 27 00:59:59 2022 GMT isdst=0 gmtoff=0
Europe/London  Sun Mar 27 01:00:00 2022 UT = Sun Mar 27 02:00:00 2022 BST isdst=1 gmtoff=3600
Europe/London  Sun Oct 30 00:59:59 2022 UT = Sun Oct 30 01:59:59 2022 BST isdst=1 gmtoff=3600
Europe/London  Sun Oct 30 01:00:00 2022 UT = Sun Oct 30 01:00:00 2022 GMT isdst=0 gmtoff=0
Europe/London  Sun Mar 26 00:59:59 2023 UT = Sun Mar 26 00:59:59 2023 GMT isdst=0 gmtoff=0
Europe/London  Sun Mar 26 01:00:00 2023 UT = Sun Mar 26 02:00:00 2023 BST isdst=1 gmtoff=3600
Europe/London  Sun Oct 29 00:59:59 2023 UT = Sun Oct 29 01:59:59 2023 BST isdst=1 gmtoff=3600
Europe/London  Sun Oct 29 01:00:00 2023 UT = Sun Oct 29 01:00:00 2023 GMT isdst=0 gmtoff=0
Europe/London  Sun Mar 31 00:59:59 2024 UT = Sun Mar 31 00:59:59 2024 GMT isdst=0 gmtoff=0
Europe/London  Sun Mar 31 01:00:00 2024 UT = Sun Mar 31 02:00:00 2024 BST isdst=1 gmtoff=3600
Europe/London  Sun Oct 27 00:59:59 2024 UT = Sun Oct 27 01:59:59 2024 BST isdst=1 gmtoff=3600
Europe/London  Sun Oct 27 01:00:00 2024 UT = Sun Oct 27 01:00:00 2024 GMT isdst=0 gmtoff=0
</code></pre>
<p>2022-03-27 has 23 hours from 00:00 to 23:59</p>
<h2 id="tz-database---时区转换的正规做法"><a class="header" href="#tz-database---时区转换的正规做法">TZ database - 时区转换的正规做法</a></h2>
<p>RFC 8536: The Time Zone Information Format (TZif)</p>
<ul>
<li>https://en.wikipedia.org/wiki/List_of_tz_database_time_zones</li>
<li>/usr/share/zoneinfo/</li>
<li><code> man 5 tzfile</code></li>
</ul>
<p>To parse the file, we have many readers:</p>
<ul>
<li>official tzcode, reference implementation</li>
<li>c glibc</li>
<li>c++ abseil/cctz</li>
<li>Golang</li>
<li>Java</li>
<li>Python, zoneinfo(PEP 615, Python 3.9, 2020), pytz</li>
</ul>
<h3 id="abseil-time-library-1"><a class="header" href="#abseil-time-library-1">Abseil time library</a></h3>
<p>API desgin: prefers(namespace level) free functions over member functions. 
from: <a href="https://abseil.io/blog/20181129-moderncpp">CppCon 2018: Modern C++ Design</a></p>
<pre><code>absl::Time now = absl::now();
absl::Duration hour = absl::Hours(1);
absl::Time hour_ago = now - hour;
</code></pre>
<ul>
<li>区分Absolute Time, Civil Time, 用Timezone class 在二者间转换</li>
<li>不要写加减 UTC offset 的代码</li>
<li>Don't use default local timezone on servers. Or, set to UTC on all servers.</li>
<li>Use explicit timezone, to serve clients from different regions.</li>
</ul>
<h2 id="refer"><a class="header" href="#refer">refer</a></h2>
<ul>
<li><a href="https://www.codethink.co.uk/articles/2020/building-the-abseil-hello-bazel-project-for-a-different-architecture-using-a-dynamically-generated-toolchain/">Building the abseil-hello Bazel project for a different architecture using a dynamically generated toolchain</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="docker"><a class="header" href="#docker">Docker</a></h1>
<p>$ docker run -it stammerer:1.0.0 bash</p>
<ul>
<li>
<p>MYSQL: <code>$ docker run -d -p 3306:3306 -name mysql01 -e MYSQL_ROOT_PASSWORD=123456 mysql:5.7.32</code></p>
</li>
<li>
<p>Rabbitmq: <code>$ docker run -d -p 5672:5672 -name rabbitmq01</code></p>
<ul>
<li>5672 是 客户端与rabbitmq交互的端口号</li>
<li>15672 是 客户端与rabbitmq Web页面交互的端口号</li>
</ul>
</li>
<li>
<p>nacos 镜像运行: <code>docker run -d --name ncos-standalone -e MODE=standalone -p 8848:8848 nacos/nacos-server:latest</code></p>
</li>
</ul>
<h3 id="run-cmd-entrypoint"><a class="header" href="#run-cmd-entrypoint">RUN, CMD, ENTRYPOINT</a></h3>
<ul>
<li><strong>RUN</strong> 执行命令并创建新的镜像层，RUN 经常用于安装软件包，比如这里的 npm install；</li>
<li><strong>CMD</strong> 设置容器启动后默认执行的命令及其参数，但 CMD 能够被 docker run 后面跟的命令行参数替换。</li>
<li><strong>ENTRYPOINT</strong> 配置容器启动时运行的命令。</li>
</ul>
<h3 id="workdir"><a class="header" href="#workdir">WORKDIR</a></h3>
<p><strong>WORKDIR</strong> creates the path if it doesn't exist and then changes the current directory to that path (same as <code>mkdir -p /path/new &amp;&amp; cd /path/new</code>)
For example:</p>
<pre><code>WORKDIR /Users/vaibmish/Documents/new/graph-report/graphreport_metrics
</code></pre>
<p>You can also declare the path as a volume and instruct who runs the container to provide their own path (<code>docker run -v host_path:container_path ...</code>)</p>
<h3 id="volume"><a class="header" href="#volume">VOLUME</a></h3>
<p>For example:</p>
<pre><code>VOLUME /Users/vaibmish/Documents/new/graph-report
</code></pre>
<p>A final note: It looks like these paths are from the host. Remember that the paths in the Dockerfile are not host paths. They are paths inside the container.</p>
<h3 id="暴露端口"><a class="header" href="#暴露端口">暴露端口</a></h3>
<pre><code>    EXPOSE 3000
</code></pre>
<h3 id="image-转储"><a class="header" href="#image-转储">Image 转储</a></h3>
<ul>
<li>保存镜像为文件</li>
</ul>
<p>如果要讲镜像保存为本地文件，可以使用Docker save命令。</p>
<pre><code>docker save -o 要保存的文件名  要保存的镜像
</code></pre>
<ul>
<li>从文件载入镜像</li>
</ul>
<pre><code>docker load --input 文件
	
docker load &lt; 文件名
</code></pre>
<p>此时会导入镜像以及相关的元数据信息等</p>
<h2 id="五个小技巧快速创建docker镜像"><a class="header" href="#五个小技巧快速创建docker镜像">五个小技巧，快速创建Docker镜像</a></h2>
<p>毫无疑问，容器是DevOps世界一个突破性的技术。镜像创建对于部署和发布环节都非常重要。那么如何效率地创建和使用镜像来提升部署速度呢？以下是作者的经验和分享，大家不妨一试——</p>
<ul>
<li>
<ol>
<li>尽可能多地缓存网络下载</li>
</ol>
</li>
</ul>
<p>通常部署需要从Internet下载成百上千MB的数据。因此部署常受到网速慢或者断网的困扰。</p>
<p>而缓存得越多，部署得就会越快。最终的目标是实现Docker镜像离线一键部署。</p>
<ul>
<li>
<ol start="2">
<li>把Docker镜像看做Plain OS Golden Image</li>
</ol>
</li>
</ul>
<p>Docker很强力，但是我们也有很多VM或者裸机部署。为了避免供应商锁定，通常需要选择是否用Docker支持部署，最好两种场景都实施部署持续集成。</p>
<p>举例来说，如果使用kitchen来做持续集成。默认情况下，使用自定义Docker镜像来测试。当IMAGE_NAME指定为ubuntu:14.04时，可以很肯定ubuntu:14.04系统对于部署非常适用。</p>
<ul>
<li>
<ol start="3">
<li>审核Docker镜像里所有包和服务的安装</li>
</ol>
</li>
</ul>
<p>从镜像起一个Docker容器，然后列出并检查所有安装的包/服务。</p>
<p>为什么要这么做？首先我们希望Docker镜像尽可能地小，镜像交付就会很快速。其次，包/服务越多，问题也会越多，例如包冲突，TCP端口占有问题。一些服务的安装后脚本甚至会改变关键性的全局配置文件或者留下不可预期的flagfile。所以最好让Docker镜像保持傻傻的单纯。</p>
<ul>
<li>
<ol start="4">
<li>Docker构建的最后清理关闭所有服务</li>
</ol>
</li>
</ul>
<p>如果不这么做，服务会在Docker镜像的最后阶段被杀掉。在/var/lock/*下的服务的lockfile如果没有被正确使用，当测试新建镜像的部署时，服务可能会启动失败，导致测试无效。</p>
<ul>
<li>
<ol start="5">
<li>添加验证步骤，确保镜像正常</li>
</ol>
</li>
</ul>
<p>当有改变发生时，我们时不时需要重构Docker镜像。为了确保一切正常，我们可以在Docker构建过程中添加自动验证逻辑。</p>
<p>这是一个简单的例子，实践了上述提到的技巧。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ide"><a class="header" href="#ide">IDE</a></h1>
<h2 id="codelite"><a class="header" href="#codelite"><a href="https://codelite.org/">CodeLite</a></a></h2>
<p>CodeLite is an open source, free, cross platform IDE, specialized in C, C++, Rust, Python, PHP and JavaScript (mainly for backend developers using Node.js) programming languages which runs best on all major Platforms ( OSX, Windows and Linux )</p>
<ul>
<li><a href="https://github.com/eranif/codelite">Source code on github</a></li>
</ul>
<h2 id="pycharm"><a class="header" href="#pycharm">PyCharm</a></h2>
<h2 id="vscode"><a class="header" href="#vscode">VSCode</a></h2>
<div style="break-before: page; page-break-before: always;"></div><h1 id="git"><a class="header" href="#git">Git</a></h1>
<h2 id="setting-your-email-address-for-a-single-repository"><a class="header" href="#setting-your-email-address-for-a-single-repository">Setting your email address for a single repository</a></h2>
<p>GitHub uses the <strong>email address</strong> set in your local Git configuration to associate commits pushed from the command line with your account on GitHub.com.</p>
<p>You can change the <strong>email address</strong> associated with commits you make in a single repository.
This will override your global Git configuration settings in this one repository, but will not affect any other repositories.</p>
<ul>
<li>Set an email address in Git.</li>
</ul>
<pre><code>$ git config user.email &quot;YOUR_EMAIL&quot;
</code></pre>
<ul>
<li>Confirm that you have set the email address correctly in Git:</li>
</ul>
<pre><code>$ git config user.email
email@example.com
</code></pre>
<p>and the new <code>.git/config</code> will be generated for this project.</p>
<h2 id="how-to-change-author-of-last-commits"><a class="header" href="#how-to-change-author-of-last-commits">How to change author of last commits</a></h2>
<ul>
<li>First find your commit:</li>
</ul>
<pre><code>$ git log
</code></pre>
<p>Then copy the last commit ID (one commit after your target commit. it means your target commit + 1).</p>
<ul>
<li>Then start rebase:</li>
</ul>
<pre><code>$ git rebase -i 234234rfsdfrq3213412e412
</code></pre>
<p>This command will open your EDITOR, change your target commits from <code>pick</code> to <code>edit</code>. <strong>THIS ACTION IS SO IMPORTANT</strong>
Then save and close your editor.</p>
<ul>
<li>Then amend your commit (with your details):</li>
</ul>
<pre><code>$ git commit --amend --author=&quot;Morteza Nourelahi Alamdari &lt;me@mortezana.com&gt;&quot;
</code></pre>
<ul>
<li>Then keep rebase continue:</li>
</ul>
<pre><code>$ git rebase --continue
</code></pre>
<p>Again try do amend line.
Again try keep rebase continue line.</p>
<ul>
<li>Until rebase command says (all <code>edit</code> lines completed successfully):</li>
</ul>
<pre><code>Successfully rebased and updated 
</code></pre>
<p>Now your commits are changed successfully.</p>
<ul>
<li>Now if you want to push your commits to the server, try to push it with <code>-f</code> option:</li>
</ul>
<pre><code>$ git push origin master -f
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="screen"><a class="header" href="#screen">Screen</a></h1>
<h2 id="setup"><a class="header" href="#setup">Setup</a></h2>
<pre><code>$ cat ~/.screenrc
# Turn off the welcome message
startup_message off

# Disable visual bell
vbell off

# Set scrollback buffer to 10000
defscrollback 10000

# Customize the status line
hardstatus alwayslastline
hardstatus string '%{= kG}[ %{G}%H %{g}][%= %{= kw}%?%-Lw%?%{r}(%{W}%n*%f%t%?(%u)%?%{r})%{w}%?%+Lw%?%?%= %{g}][%{B} %m-%d %{W}%c %{g}]'
</code></pre>
<h2 id="shortcuts"><a class="header" href="#shortcuts">Shortcuts</a></h2>
<ul>
<li>拷贝方法：进入拷贝模式后，移动到复制开始点，按空格，再移动到赋值结束点，按空格，完毕(注：无法拷贝到剪贴板，只能在screen窗口间拷贝。)。</li>
<li>粘贴： <code>ctrl + a ]</code></li>
</ul>
<h2 id="faq-how-to-scollback-in-gnu-screen"><a class="header" href="#faq-how-to-scollback-in-gnu-screen">FAQ: How to scollback in GNU Screen?</a></h2>
<ul>
<li>Enter the COPY mode: <code>ctrl + a [</code></li>
<li>Then:
<ul>
<li><strong>h</strong> -    Move the cursor left by one character</li>
<li><strong>j</strong> -    Move the cursor down by one line</li>
<li><strong>k</strong> -    Move the cursor up by one line</li>
<li><strong>l</strong> -    Move the cursor right by one character</li>
<li><strong>0</strong> -    Move to the beginning of the current line</li>
<li><strong>$</strong> -    Move to the end of the current line.</li>
<li><strong>G</strong> -    Moves to the specified line (defaults to the end of the buffer).</li>
<li><strong>Ctrl-u</strong> -  Scrolls a half page up.</li>
<li><strong>Ctrl-b</strong> -  Scrolls a full page up.</li>
<li><strong>Ctrl-d</strong> -  Scrolls a half page down.</li>
<li><strong>Ctrl-f</strong> -  Scrolls the full page down.</li>
</ul>
</li>
<li>Left it: press the <code>esc</code> key.</li>
</ul>
<p>设置Screen的缓存Buffer：</p>
<pre><code>vim ~/.screenrc
 #设置screen窗口缓存100万行
defscrollback 40000
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sqlite"><a class="header" href="#sqlite"><a href="https://www.sqlite.org/index.html">SQLite</a></a></h1>
<ul>
<li>What Is SQLite?</li>
</ul>
<p>SQLite is a C-language library that implements a small, fast, self-contained, high-reliability, full-featured, SQL database engine.</p>
<p>SQLite is the most used database engine in the world. SQLite is built into all mobile phones and most computers and comes bundled inside countless other applications that people use every day.</p>
<ul>
<li><a href="https://www.sqlite.org/fasterthanfs.html">35% Faster Than The Filesystem</a>
<ul>
<li>Further performance improves can be made by using the memory-mapped I/O feature of SQLite. </li>
<li>blobs are read (in random order) using the sqlite3_blob_read() interface. </li>
</ul>
</li>
</ul>
<h2 id="db-browser-for-sqlite"><a class="header" href="#db-browser-for-sqlite"><a href="SQLite/www.sqlitebrowser.org">DB Browser for SQLite</a></a></h2>
<p>The Official home of the DB Browser for SQLite</p>
<ul>
<li><a href="https://github.com/sqlitebrowser/sqlitebrowser/wiki">sqlitebrowser on github</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ubuntu"><a class="header" href="#ubuntu">Ubuntu</a></h1>
<h2 id="how-to-resolve-the-trying-to-overwrite-issue"><a class="header" href="#how-to-resolve-the-trying-to-overwrite-issue">How to resolve the “trying to overwrite” Issue?</a></h2>
<p>Detail error log as below:</p>
<pre><code>Unpacking python-catkin-pkg-modules (0.5.2-1) ... 
dpkg: error processing archive /var/cache/apt/archives/python-catkin-pkg-modules_0.5.2-1_all.deb (--unpack): 
 trying to overwrite '/usr/lib/python2.7/dist-packages/catkin_pkg/__init__.py', which is also in package python-catkin-pkg 0.3.9-1 
</code></pre>
<ul>
<li>With DPKG</li>
</ul>
<p>If the error occurred while you were executing the apt command, then use the command as follows.</p>
<pre><code>sudo dpkg -i --force-overwrite theDebYouWantToInstall.deb
sudo apt-get --fix-broken install
</code></pre>
<p>This command will install the deb file with file overwriting when needed.</p>
<ul>
<li>With APT
If the error occurred while you were executing the dpkg command, then use the command as follows.</li>
</ul>
<pre><code>sudo apt-get -o Dpkg::Options::=&quot;--force-overwrite&quot; install &lt;package-name&gt;
</code></pre>
<p>So, the solution above does help fix the error.</p>
<pre><code>ENV ROS_DISTRO=melodic
LABEL ROS_DISTRO=&quot;${ROS_DISTRO}&quot;
RUN apt-get update &amp;&amp; apt-get -o Dpkg::Options::=&quot;--force-overwrite&quot; -y --no-install-recommends install \                                                                                                   
        ros-$ROS_DISTRO-pcl-msgs \
        ros-$ROS_DISTRO-pcl-conversions=1.7.1-1bionic \
        ros-$ROS_DISTRO-pcl-ros=1.7.1-1bionic \
        &amp;&amp; apt-get clean &amp;&amp; rm -rf /var/lib/apt/lists/*
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->

        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </body>
</html>
